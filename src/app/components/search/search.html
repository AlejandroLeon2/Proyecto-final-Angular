<form
  (ngSubmit)="onViewAllResults($event)"
  class="flex flex-col justify-center min-w-40 h-10 rounded-lg focus-within:ring-1 focus-within:ring-white"
  >
  <div class="flex w-full flex-1 rounded-lg h-full">
    <label
      for="searchInput"
      class="flex items-center justify-center pl-2 pr-1 rounded-l-lg border-r-0 text-[var(--text-main)] bg-[var(--border-input)]"
    >
    <lucide-icon [img]="search"></lucide-icon>
    </label>

    <input
      id="searchInput"
      name="searchInput"

      (keyup)="onSearchKeyUp()"

      class="form-input flex w-full min-w-0 flex-1 resize-none overflow-hidden rounded-lg rounded-l-none text-[var(--text-main)] border border-[var(--border-input)] h-full placeholder:text-[var(--text-soft)] pl-2 text-sm font-normal focus:outline-none focus:ring-0 focus:border-transparent"
      placeholder="Search products..."
      [(ngModel)]="wordKey"
    />
  </div>
  <!-- si wordKey tiene contenido mostramos resultados -->
  @if (wordKey.length > 0 && wordKey.trim() !== '') {
    <div
      (click)="clearSearch()"
      class="absolute top-15 left-0 h-[90vh] gap-2 w-full bg-[#0000008a] flex flex-col overflow-y-auto rounded-b-lg items-center p-4 pt-2 shadow-lg z-50">

      <div class="w-[70%] h-auto flex flex-wrap justify-center items-center my-4 gap-3">
        <!-- contenedor de conincidencias del search -->
        @if (resultados.success){
          @for( product of resultados.data?.products; track product.id) {
            <!-- mostramos imagen , nombre y precio del producto -->
            <div 
              class="flex flex-col items-center w-64 rounded-xl border border-[var(--bg-input)] bg-[var(--bg-main)] hover:bg-[var(--bg-input-hover)] cursor-pointer transition-all duration-200 shadow-md hover:shadow-xl overflow-hidden"
              (click)="onSelectProduct(product)">

              <!-- Imagen del producto -->
              <div class="w-full h-48 overflow-hidden rounded-t-xl">
                <img 
                  [src]="product.image" 
                  alt="{{ product.name }}" 
                  class="w-full h-full object-cover transition-transform duration-300 hover:scale-105" />
              </div>

              <!-- Contenedor de informaciÃ³n del producto -->
              <div class="w-full p-3 flex flex-col items-center bg-[var(--bg-main)]">
                <span class="text-center text-sm font-semibold text-[var(--text-main)] truncate w-full" title="{{ product.name }}">
                  {{ product.name }}
                </span>
              </div>
            </div>
            }
          }
        @else {
          <div class=" p-2 text-sm text-[var(--text-soft)]">
            {{resultados.message}} 
          </div>
        }
      </div>
      <!-- si el resultado tiene mas items mostrar un btn para ver todos -->
      @if (resultados.success && resultados.data?.moreItems) {
        <div class="w-full flex justify-center mb-4">
          <button
            (click)="onViewAllResults($event)"
            class="px-4 py-2 bg-[var(--primary)] text-white rounded-lg border-[var(--primary)] bg-[var(--primary)] hover:bg-[var(--primary-hover)] cursor-pointer transition-all duration-200 shadow-md hover:shadow-xl  hover:scale-105"
          >
            Ver todos los resultados
          </button>
        </div>
      }
    </div>
  }
</form>
